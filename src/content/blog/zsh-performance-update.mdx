export const metadata = {
  title: "ëŠë ¤ì§„ zsh í„°ë¯¸ë„ ì„±ëŠ¥ ìµœì í™”",
  publishedAt: "2025-10-03",
};

# {metadata.title}

ê°œë°œí•  ë•ŒëŠ” ì£¼ë¡œ neovimì„ ì‚¬ìš©í•˜ë‹¤ ë³´ë‹ˆ, í„°ë¯¸ë„ì—ì„œ ëª¨ë“  ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ë°
ì‰˜ì´ ì¼œì§€ëŠ” ì†ë„ê°€ ê°‘ìê¸° ë„ˆë¬´ ëŠë¦° ê²Œ ëŠê»´ì§€ëŠ” ê²ƒì´ì—ˆë‹¤.

ëŠë¦° ì›ì¸ì„ ì°¾ê³  ê°œì„ í•˜ê¸° ìœ„í•œ ì—¬ì •ì´ë‹¤.

## ëª©ì°¨

## ì›ì¸ ì°¾ê¸°

[zsh-bench](https://github.com/romkatv/zsh-bench)ì„ ëŒë ¤ë³´ì•˜ë‹¤.

```sh
# ì„¤ì¹˜í•˜ê³  ì‹¤í–‰
> ~/zsh-bench/zsh-bench
```

![zsh-bench-result](/zsh-performance-update/zsh-bench.png)

ëˆˆ ì—¬ê²¨ë³¼ê±´ ì´ê±°ë‹¤. `first_prompt_lag_ms=1409.696`

ì²˜ìŒ í‚¤ê³  í”„ë¡¬í”„íŠ¸ ì…ë ¥í• ìˆ˜ ìˆì„ë•Œ ê¹Œì§€ `1409ms`ê°€ ê±¸ë¦°ë‹¤.
ê·¸ëŸ¬ë©´ ì´ì œ `zsh/zprof`ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¬´ì—‡ ë•Œë¬¸ì— ëŠë¦°ì§€ ì‚´í´ë³´ì

```sh
# .zshrc ì— í•´ë‹¹ ë¼ì¸ ì¶”ê°€
zmodload zsh/zprof
```

```sh
# ì‹¤í–‰
> zprof
```

![zprof](/zsh-performance-update/zprof.png)

nvmì´ ë§ì´ ëŠë¦°í¸ì¸ê±¸ ì•Œ ìˆ˜ ìˆë‹¤.

## ê°œì„  í•˜ê¸°

nvmì„ ì œê±°í•˜ê³  í•˜ëŠ”ê¹€ì— í”ŒëŸ¬ê·¸ì¸ ë§¤ë‹ˆì €ê¹Œì§€ ë³€ê²½í•˜ì˜€ë‹¤.

- nvm ëŒ€ì•ˆì±… ì°¾ê¸° => [Volta](https://volta.sh/)
- oh-my-zsh => [antidote](https://github.com/mattmc3/antidote)

ë³¸ì¸ì€ nix[^1]ë¥¼ ì‚¬ìš©í•˜ê¸°ì— ì•„ë˜ì™€ ê°™ì´ ì„¤ì •ì„ í•˜ì˜€ë‹¤.

[^1]: nixëŠ” ì„ ì–¸ì ì´ê³  ì¬í˜„ ê°€ëŠ¥í•œ ë°©ì‹ìœ¼ë¡œ ì†Œí”„íŠ¸ì›¨ì–´ íŒ¨í‚¤ì§€ë¥¼ ê´€ë¦¬í•  ìˆ˜ ìˆëŠ” ë„êµ¬ì…ë‹ˆë‹¤. ìì„¸í•œ ë‚´ìš©ì€ [nix ê³µì‹ ì›¹ì‚¬ì´íŠ¸](https://nixos.org/)ë¥¼ ì°¸ì¡°í•˜ì„¸ìš”.

```nix
# configuration.nix
{
  environment.systemPackages = with pkgs; [
    ...,
    volta
  ]

  programs.zsh = {
    enable = true;
    enableBashCompletion = false;
    enableCompletion = false;
    variables = {
      ZDOTDIR = "$HOME/.config/zsh";
    };
    promptInit = ''
      fpath=(${pkgs.antidote}/share/antidote/functions $fpath)
      autoload -Uz antidote
    '';
  };
}
```

## ê²°ê³¼

![zsh-bench-result-2](/zsh-performance-update/result2.png)

first_prompt_lag_msê°€ `39.118ms`ë¡œ ì¤„ì—ˆë‹¤. (97.22% ë¹¨ë¼ì§)
`volta` ë„ nvm ë³´ë‹¤ íœ ì”¬ ê°„ë‹¨í•˜ê³  ë¹ ë¥´ë‹¤.

ì•„ì£¼ ì¾Œì í•˜ê³  ë§Œì¡±ìŠ¤ëŸ½ë‹¤.ğŸ™‚

## ì¶”ê°€ì ìœ¼ë¡œ

`omz` í”„ë ˆì„ì›Œí¬ë¥¼ ë²—ì–´ë‚˜ë‹ˆ `sub-string-search` ê¸°ëŠ¥ì´ ë¹ ì ¸ìˆë‹¤.
zsh-vi ëª¨ë“œë¥¼ ì‚¬ìš©í•˜ê¸°ì— í•´ë‹¹ ê¸°ëŠ¥ë„ ë„£ì–´ì£¼ì—ˆë‹¤.

```bash
function zvm_before_init() {
    # up, down ì‹œ íˆìŠ¤í† ë¦¬ substring search
    autoload -U history-search-end
    zle -N history-beginning-search-backward-end history-search-end
    zle -N history-beginning-search-forward-end history-search-end

    # zsh-vi-mode
    zvm_bindkey viins '^[[A' history-beginning-search-backward-end
    zvm_bindkey viins '^[[B' history-beginning-search-forward-end
    zvm_bindkey vicmd '^[[A' history-beginning-search-backward-end
    zvm_bindkey vicmd '^[[B' history-beginning-search-forward-end
}
```

> ì„¤ì •ì€ ì œ[dotfiles](https://github.com/Yanguk/dotfiles)ì—ì„œ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
